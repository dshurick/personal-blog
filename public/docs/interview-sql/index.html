<!DOCTYPE html>

<html>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interview Sql | metadata</title>

<link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono:300,400,700" rel="stylesheet">
<link rel="stylesheet" href="/normalize.min.css">

<link rel="stylesheet" href="/book.min.29d743ffb6d61ecbfc9bb21b7eab17d63b577d4bd547c3f095addb1c793ab1b1.css">
  
</head>

<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav role="navigation">
<h2 class="book-brand">
  <a href="/">metadata</a>
</h2>



    <ul>
<li><a href="/"><strong>Introduction</strong></a></li>
<li><a href="/docs/examples/">Interview Questions</a>

<ul>
<li><a href="/docs/interview-sql/">SQL</a></li>
</ul></li>
<li><a href="/posts/"><strong>Blog</strong></a></li>
</ul>




</nav>
    </aside>

    <div class="book-page">
      <header class="align-center justify-between book-header">
  <label for="menu-control">
    <img src="/svg/menu.svg" />
  </label>
  <strong>Interview Sql</strong>
</header>

      
<article class="markdown">

<h1 id="interview-questions">Interview Questions</h1>

<h2 id="sql">SQL</h2>

<h3 id="resources">Resources:</h3>

<ul>
<li><a href="https://data36.com/sql-interview-questions-tech-screening-data-analysts/">https://data36.com/sql-interview-questions-tech-screening-data-analysts/</a></li>
</ul>

<h3 id="question-1">Question 1</h3>

<p>Let’s say you have two SQL tables: <code>authors</code> and <code>books</code>.</p>

<p>The authors dataset has 1M+ rows; here’s the first six rows:</p>

<table>
<thead>
<tr>
<th>author_name</th>
<th>book_name</th>
</tr>
</thead>

<tbody>
<tr>
<td>author_1</td>
<td>book_1</td>
</tr>

<tr>
<td>author_1</td>
<td>book_2</td>
</tr>

<tr>
<td>author_2</td>
<td>book_3</td>
</tr>

<tr>
<td>author_2</td>
<td>book_4</td>
</tr>

<tr>
<td>author_2</td>
<td>book_5</td>
</tr>

<tr>
<td>author_3</td>
<td>book_6</td>
</tr>

<tr>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
</tbody>
</table>

<p>The books dataset also has 1M+ rows and here’s the first six:</p>

<table>
<thead>
<tr>
<th>book_name</th>
<th align="right">sold_copies</th>
</tr>
</thead>

<tbody>
<tr>
<td>book_1</td>
<td align="right">1000</td>
</tr>

<tr>
<td>book_2</td>
<td align="right">1500</td>
</tr>

<tr>
<td>book_3</td>
<td align="right">34000</td>
</tr>

<tr>
<td>book_4</td>
<td align="right">29000</td>
</tr>

<tr>
<td>book_5</td>
<td align="right">40000</td>
</tr>

<tr>
<td>book_6</td>
<td align="right">4400</td>
</tr>

<tr>
<td>&hellip;</td>
<td align="right">&hellip;</td>
</tr>
</tbody>
</table>

<p>Create an SQL query that shows the TOP 3 authors who sold the most books in total!</p>

<h4 id="question-1-answer">Question 1 Answer</h4>

<p>The solution code is:</p>

<pre><code class="language-sql">SELECT authors.author_name, SUM(books.sold_copies) AS sold_sum
FROM authors
JOIN books
ON books.book_name = authors.book_name
GROUP BY authors.author_name
ORDER BY sold_sum DESC
LIMIT 3;
</code></pre>

<p>And here is a short explanation:</p>

<ol>
<li>First you have to initiate the JOIN. I joined the two tables by using:</li>
</ol>

<pre><code class="language-sql">SELECT *
FROM authors
JOIN books
ON books.book_name = authors.book_name;
</code></pre>

<ol>
<li><p>After that, I used a <code>SUM()</code> function with a <code>GROUP BY</code> clause. This means that in the <code>SELECT</code> statement I had to replace the <code>*</code> with the <code>author_name</code> and <code>sold_copies</code> columns. (It’s not mandatory to indicate from which table you are selecting the columns, but it’s worth it. That’s why I used <code>authors.author_name</code> and <code>books.sold_copies</code>.)</p></li>

<li><p>Eventually, I <code>ORDER</code>ed the results in <code>DESC</code>ending order. (Just for my convenience, I also renamed the <code>sum</code> column to <code>sold_sum</code> using the <code>AS sold_sum</code> method in the <code>SELECT</code> statement.)</p></li>
</ol>

<h3 id="question-2">Question 2</h3>

<p>You work for a startup that makes an online presentation software. You have an event log that records every time a user inserted an image into a presentation. (One user can insert multiple images.) The event_log SQL table looks like this:</p>

<table>
<thead>
<tr>
<th>user_id</th>
<th align="right">event_date_time</th>
</tr>
</thead>

<tbody>
<tr>
<td>7494212</td>
<td align="right">1535308430</td>
</tr>

<tr>
<td>7494212</td>
<td align="right">1535308433</td>
</tr>

<tr>
<td>1475185</td>
<td align="right">1535308444</td>
</tr>

<tr>
<td>6946725</td>
<td align="right">1535308475</td>
</tr>

<tr>
<td>6946725</td>
<td align="right">1535308476</td>
</tr>

<tr>
<td>6946725</td>
<td align="right">1535308477</td>
</tr>

<tr>
<td>&hellip;</td>
<td align="right">&hellip;</td>
</tr>
</tbody>
</table>

<p>…and it has over one billion rows.</p>

<p>Note: If the <code>event_date_time</code> column’s format doesn’t look familiar, google “epoch timestamp”!</p>

<p>Write an SQL query to find out how many users inserted more than 1000 but less than 2000 images in their presentations!</p>

<h4 id="question-2-answer">Question 2 Answer</h4>

<p>The SQL query is:</p>

<pre><code class="language-sql">SELECT COUNT(*) FROM
  (SELECT user_id, COUNT(event_date_time) AS image_per_user
  FROM event_log
  GROUP BY user_id) AS image_per_user
WHERE image_per_user &lt; 2000 AND image_per_user &gt; 1000;
</code></pre>

<p>The trick in this task is that you had to use the <code>COUNT()</code> function two times: first, you had to count the number of images per user, then the number of users (who fulfill the given condition). The easiest way to do that is to use a subquery.</p>

<ol>
<li>Write the inner query first! Run a simple COUNT() function with a GROUP BY clause on the event_log table.</li>
<li>Make sure that you create an alias for the subquery (AS image_per_user). It’s a syntax requirement in SQL.</li>
<li>Eventually, in an outer query, apply a WHERE filter and a COUNT() function on the result of the subquery.</li>
</ol>

<h3 id="question-3">Question 3</h3>

<p>You have two SQL tables! The first one is called employees and it contains the employee names, the unique employee ids and the department names of a company. Sample:</p>

<table>
<thead>
<tr>
<th>department_name</th>
<th align="right">employee_id</th>
<th align="right">employee_name</th>
</tr>
</thead>

<tbody>
<tr>
<td>Sales</td>
<td align="right">123</td>
<td align="right">John Doe</td>
</tr>

<tr>
<td>Sales</td>
<td align="right">211</td>
<td align="right">Jane Smith</td>
</tr>

<tr>
<td>HR</td>
<td align="right">556</td>
<td align="right">Billy Bob</td>
</tr>

<tr>
<td>Sales</td>
<td align="right">711</td>
<td align="right">Robert Hayek</td>
</tr>

<tr>
<td>Marketing</td>
<td align="right">235</td>
<td align="right">Edward Jorgson</td>
</tr>

<tr>
<td>Marketing</td>
<td align="right">236</td>
<td align="right">Christine Packard</td>
</tr>

<tr>
<td>&hellip;</td>
<td align="right">&hellip;</td>
<td align="right">&hellip;</td>
</tr>
</tbody>
</table>

<p>The second one is named salaries. It holds the same employee names and the same employee ids – and the salaries for each employee. Sample:</p>

<table>
<thead>
<tr>
<th align="right">salary</th>
<th align="right">employee_id</th>
<th align="right">employee_name</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">500</td>
<td align="right">123</td>
<td align="right">John Doe</td>
</tr>

<tr>
<td align="right">600</td>
<td align="right">211</td>
<td align="right">Jane Smith</td>
</tr>

<tr>
<td align="right">1000</td>
<td align="right">556</td>
<td align="right">Billy Bob</td>
</tr>

<tr>
<td align="right">400</td>
<td align="right">711</td>
<td align="right">Robert Hayek</td>
</tr>

<tr>
<td align="right">1200</td>
<td align="right">235</td>
<td align="right">Edward Jorgson</td>
</tr>

<tr>
<td align="right">200</td>
<td align="right">236</td>
<td align="right">Christine Packard</td>
</tr>

<tr>
<td align="right">&hellip;</td>
<td align="right">&hellip;</td>
<td align="right">&hellip;</td>
</tr>
</tbody>
</table>

<p>The company has 546 employees, so both tables have 546 rows.</p>

<p>Print every department where the average salary per employee is lower than $500!</p>

<h4 id="question-3-answer">Question 3 Answer</h4>

<p>Solution:</p>

<pre><code class="language-sql">SELECT department_name, AVG(salaries.salary) AS avg_salaries
FROM employees
JOIN salaries
ON employees.employee_id = salaries.employee_id
GROUP BY department_name
HAVING AVG(salaries.salary) &lt; 500;
</code></pre>

<p>Note: You can solve this task using a subquery, too – but in an interview situation the committee will like the above solution better.</p>

<p>Brief explanation:</p>

<ol>
<li>First JOIN the two tables:</li>
</ol>

<pre><code class="language-sql">SELECT *
FROM employees
JOIN salaries
ON employees.employee_id = salaries.employee_id;
</code></pre>

<p>Watch out! Use the <code>employee_id</code> column – not the <code>employee_name</code>. (You can always have two John Does at a company, but the employee id is unique!)</p>

<ol>
<li><p>Then use an <code>AVG()</code> function with a <code>GROUP BY</code> clause — and replace the <code>*</code> with the appropriate columns. (Just like in the first task.)</p></li>

<li><p>And the last step is to use a <code>HAVING</code> clause to filter by the result of the <code>AVG()</code> function. (Remember: <code>WHERE</code> is not good here because it would be initiated before the <code>AVG()</code> function.)
Watch out: in the <code>HAVING</code> line, you can’t refer to the alias – you have to use the whole function itself again!</p></li>
</ol>
</article>

      
<div class="align-center book-git-footer justify-end">
  
  
  <div>
    <a href="https://github.com/dshurick/personal-blog/edit/master/exampleSite/content/docs/interview-sql.md" target="_blank" rel="noopener">
      <img src="/svg/code-fork.svg" /> Edit this page
    </a>
  </div>
  
</div>


    </div>

    
  
  
  <aside class="book-toc fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#interview-questions">Interview Questions</a>
<ul>
<li><a href="#sql">SQL</a>
<ul>
<li><a href="#resources">Resources:</a></li>
<li><a href="#question-1">Question 1</a>
<ul>
<li><a href="#question-1-answer">Question 1 Answer</a></li>
</ul></li>
<li><a href="#question-2">Question 2</a>
<ul>
<li><a href="#question-2-answer">Question 2 Answer</a></li>
</ul></li>
<li><a href="#question-3">Question 3</a>
<ul>
<li><a href="#question-3-answer">Question 3 Answer</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
</body>

</html>
